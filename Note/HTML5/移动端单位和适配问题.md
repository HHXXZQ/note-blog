# 常用开发单位和移动端适配问题

## 前端开发常用单位

### 像素(`Pixel`)

常用固定单位，**不随视口变化而变化**。

### 百分比

常用想对单位，总是以当前元素的父元素作为参考进行计算，例如：

> 如果父元素宽为200px，高为100px，当子元素宽高设置为50%时，子元素具体宽为100px，高为50px，且总是如此。

**注意：**`border`属性不可通过百分比设置宽度

且：

1. 子元素`padding`无论是水平还是垂直方向都是参考**父元素宽度**计算的
2. 子元素`margin`无论是水平还是垂直方向都是参考**父元素宽度**计算的

### em

em是前端开发中的一个动态单位, 是一个相对于元素字体大小的单位，例如：`font-size: 12px; `那么1em就等于`12px`。

```css
.son{
            font-size: 12px;
            width: 10em;		/* 120px */
            height: 10em;		/* 120px */
            background: blue;
}
```

#### 要点

1. 当前元素设置了字体大小, 那么就相对于当前元素的字体大小
2. 当前元素没有设置字体大小, 那么就逐级向祖先元素查找，找到的**第一个设置字体大小的祖先元素的字体大小**
3. **如果当前元素和所有祖先元素都没有设置大小, 那么就相当于浏览器默认的字体大小**

### rem

rem就是`root em`, 和`em`是前端开发中的一个*动态单位*，`rem`和`em`的区别在于, `rem`是一个**相对于根元素字体大小的单位**，例如 **根元素(html)** `font-size: 12px; `，那么`1rem`就等于`12px`。

#### 要点

1. 除了根元素以外, 其它祖先元素的字体大小不会影响rem尺寸
2. 如果根元素设置了字体大小, 那么就相对于根元素的字体大小
3. *如果根元素没有设置字体大小, 那么就相对于浏览器默认的字体大小*

### vw 和 vh

`vw`(`Viewport Width`)和`vh`(`Viewport Height`)。相对单位, 相对于网页视口的单位。系统会将视口的宽度和高度分为100份,`1vw`就占用视口宽度的*百分之一*,` 1vh`就占用视口高度的*百分之一*。

#### 要点

1. `vw`和`vh`和`百分比`不同的是, `百分比`永远都是以父元素作为参考，而`vw`和`vh`永远都是<u>以视口作为参考</u>。
2. `vw/vh`是一个动态的单位, 会随着*视口大小的变化而变化*(相对单位)

### vmin 和 vmax

> 主要用于保证移动开发中屏幕旋转之后尺寸不变

`vmin`: `vw`和`vh`中较小的那个。

`vmax`: `vw`和`vh`中较大的那个。

### 设备像素和CSS像素

设备像素又称为物理像素, 是"物理屏幕"上真实存在的发光点，只有屏幕一经出厂就固定不会改变。CSS像素又称为逻辑像素，是编程世界中虚拟的东西, 我们通过代码设置的像素都是逻辑像素。

例如:

1. ` iPhone3G/iPhone3GS 3.5英寸/ 逻辑像素320*480 / 设备像素320*480`
2.  `iPhone4/4S         3.5英寸/ 逻辑像素320*480 / 设备像素640*960`
3. CSS像素和设备像素在有的时候是不一样的

#### 设备像素和CSS像素不一致的情形

1. 在PC端，1个CSS像素往往都是对应着电脑屏幕的1个物理像素，所以我们无需关心PC端的CSS像素和设备像素
2. 在手机端，高分屏设备的出现让尺寸不变化的屏幕中出现更大分辨率的屏幕，像素点因此也就无法一致。
3. iPhone个设备的屏幕尺寸和像素

![image-20210224140612584](https://gitee.com/lijiangdao/notebook-map-bed/raw/master/noteIMG/image-20210224140612584.png)

## 移动端适配

### 移动端视口

> 可视区域大小我们称之为视口。

**PC端**：视口大小就是浏览器窗口可视区域的大小。

**移动端**：视口大小并不等于窗口大小， 移动端视口宽度被定义为**980px**。

#### 移动端不自动缩放网页尺寸

通过`meta`设置视口大小

```html
<meta name="viewport" content="width=device-width, initial-scale=1.0">
```

可选属性有：

1. `width=device-width `：设置视口宽度等于设备的宽度
2. `initial-scale=1.0 `：初始缩放比例, 1不缩放
3. `maximum-scale`：允许用户缩放到的最大比例
4. `minimum-scale`：允许用户缩放到的最小比例
5. `user-scalable=no`：用户不允许使用手动缩放

### 方案一

通过`媒体查询`的宽度来执行不同的css代码，最终达到界面的适配。

#### 优势

1. 简单明了
2. 调整屏幕，不必刷新设备
3. 适用于`PC端`和`移动端`同一套代码的项目

#### 劣势

1. 代码量大、冗余，不易于维护
2. 只适合简单网页
3. 设备资源浪费，性能低

**总结**：不推荐使用，更多项目是`PC端`和`移动端`各一套代码。

### 方案二

**媒体查询+`rem`**

1. 等比缩放
   1. 将设计图片等分为指定份数,求出每一份的大小。例如: 750设计图片分为7.5份, 那么每一份的大小就是100px
   2. 将目标屏幕也等分为指定份数,求出每一份的大小。例如: 375屏幕也分为7.5份, 那么每一份的大小就是50px
   3. 用 `原始元素尺寸 / 原始图片每一份大小 * 目标屏幕每一份大小 = 等比缩放后的尺寸`
         例如: 设计图片上有一个`150*150`的图片, 我想等比缩放显示到375屏幕上
         那么: `150 / 100 * 50 = 1.5*50 = 75px`
2. 前端开发中应用等比缩放计算公式
   1. 目标屏幕每一份的大小就是`html`的`font-size: 50px;`
   2. 使用时只需要用 `"原始元素尺寸 / 原始图片每一份大小rem"` 即可， `150 / 100 = 1.5 / 1.5rem`，` 1rem = 50px  / 1.5rem === 1.5*50 = 75px`。

### 方案三

使用 JavaScript 动态计算。

`document.documentElement.style.fontSize = window.innerWidth / 7.5 + "px"`。之后的各元素尺寸都通过响应的等比缩放计算公式计算出其单位为`rem`的数值。

#### 方案四:100:

由于设备物理像素于逻辑像素不一致时，需要对其进行缩放处理，此时可通过获取到设备像素比率，设置`<meta name="viewport">`的`initail-scale`等属性进行缩放。

```js
let scale = 1.0 / window.devicePixelRatio
let text = `meta name="viewport" content="width=device-width, initial-scale=${scale}, maximum-scale=${scale}, minimum-scale=${scale}, user-scalable=no">`
document.write(text) // 写入至页面 head 标签
document.documentElement.style.fontSize = window.innerWidth / 7.5 + "px"
```

### PC端自动跳转至移动端

关键点：`navigator.userAgent`获取到用户正在使用何种平台和系统。当中包含`Android`或`iPhone`时即可判定用户采用移动设备访问网页，应跳转至移动端页面访问网站。

















